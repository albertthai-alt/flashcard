<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Flashcards</title>
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect width='100' height='100' fill='%23FF8C00' rx='15'/><text x='50%' y='75%' font-family='Arial' font-weight='bold' font-size='80' text-anchor='middle' fill='white'>f</text><rect x='90' y='10' width='4' height='80' fill='white' rx='2'/><rect x='80' y='10' width='4' height='80' fill='white' fill-opacity='0.7' rx='2'/><rect x='10' y='90' width='80' height='4' fill='white' rx='2'/><rect x='10' y='80' width='80' height='4' fill='white' fill-opacity='0.7' rx='2'/></svg>" type="image/svg+xml">
  <link rel="shortcut icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect width='100' height='100' fill='%23FF8C00' rx='15'/><text x='50%' y='75%' font-family='Arial' font-weight='bold' font-size='80' text-anchor='middle' fill='white'>f</text><rect x='90' y='10' width='4' height='80' fill='white' rx='2'/><rect x='80' y='10' width='4' height='80' fill='white' fill-opacity='0.7' rx='2'/><rect x='10' y='90' width='80' height='4' fill='white' rx='2'/><rect x='10' y='80' width='80' height='4' fill='white' fill-opacity='0.7' rx='2'/></svg>" type="image/svg+xml">
  <link rel="stylesheet" href="./style.css" />
</head>
<body>
  <div class="container">
    <header class="header">
      <div class="brand">
        <div class="brand-title">Flashcards</div>
      </div>
      <div class="brand-right">
        <div class="brand-version">v1.12.1</div>
      </div>
    </header>
    <section class="input-section" style="padding: 10px 15px 15px;">
      <div class="summary-header" style="margin-bottom: 10px;">Thư viện</div>
      
      <div style="margin-bottom: 12px;">
        <div class="input-row" style="margin-bottom: 8px;">
          <input id="htmlFile" type="file" accept=".html,.htm,text/html" style="padding: 6px 8px;" />
          <button id="btnLoad" type="button" class="primary-btn" style="padding: 6px 10px;">Tải thẻ Quizlet HTML</button>
          <button id="btnPaste" type="button" class="secondary-btn" style="padding: 6px 10px;">Dán thẻ Quizlet HTML</button>
          <button id="btnOpen" type="button" class="secondary-btn" style="padding: 6px 10px;">Mở thẻ JSON</button>
          <button id="btnSave" type="button" class="secondary-btn" style="padding: 6px 10px;">Lưu thẻ JSON</button>
          <input id="jsonFile" type="file" accept="application/json,.json" style="display:none" />
        </div>
      </div>

      <div style="margin: 12px 0; padding-top: 8px;">
        <div style="margin: 8px 0; display: flex; gap: 8px; align-items: center;">
          <input type="text" id="notionSearchInput" class="url-input" placeholder="Tìm kiếm thẻ từ Notion..." style="flex: 1; padding: 6px 10px;" />
          <button id="btnSearchNotion" type="button" class="secondary-btn" style="padding: 6px 10px;">Tìm kiếm</button>
          <button id="btnSaveNotion" type="button" class="secondary-btn" title="Lưu bộ thẻ hiện tại vào Notion" style="padding: 6px 10px;">Lưu vào Notion</button>
        </div>
        <div id="notionDbList" style="display:flex;flex-wrap:wrap;gap:6px;margin-top:4px;"></div>
      </div>

      <div style="margin-top: 12px; padding-top: 8px; display: flex; align-items: center; gap: 10px;">
        <div class="label" style="margin: 0; font-size: 13px;">Tùy chọn:</div>
        <label style="display: flex; align-items: center; gap: 4px; margin: 0; font-size: 13px;">
          <input id="chkAppend" type="checkbox" style="margin: 0;" />
          Mở thêm
        </label>
    </section>

        <div id="status" class="status" style="min-height: 20px; font-size: 13px;"></div>
    <section id="meta" class="meta" hidden>
      <div class="meta-left">
        <div class="title" id="setTitle"></div>
        <div class="count"><span id="count">0</span> thẻ</div>
      </div>
      <div class="mode-switch" id="modeSwitch" hidden>
        <select id="cardFilter" class="filter-dropdown">
          <option value="all">Tất cả</option>
          <option value="starred">Thẻ sao</option>
          <option value="top10">Top 10</option>
          <option value="hasNotes">Thẻ ghi chú</option>
        </select>
        <label class="read-checkbox">
          <input type="checkbox" id="chkRead" checked />
          <span>Đọc</span>
        </label>
        <button id="modeStudy" class="mode-btn active">Học</button>
        <button id="modePractice" class="mode-btn">Thực hành</button>
        <button id="modeTest" class="mode-btn">Kiểm tra</button>
        <button id="modeExport" class="mode-btn">Xuất</button>
      </div>
    </section>

    

    <main id="studyView" class="view">
      <div class="study-container" id="studyContainer">
      <div class="card-area" id="cardArea" hidden>
        <div class="view-controls" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; flex-wrap: wrap; gap: 8px;">
          <div class="direction-switch" style="display:flex;gap:8px;flex:1;">
            <div style="margin-bottom: 5px;">Chế độ:</div>
            <button id="studyDirDefToTerm" type="button" class="secondary-btn">Định nghĩa → Thuật ngữ</button>
            <button id="studyDirTermToDef" type="button" class="secondary-btn active">Thuật ngữ → Định nghĩa</button>
          </div>
          <div style="display: flex; gap: 8px; align-items: center;">
            <button id="notesBtnStudy" type="button" class="notes-btn" title="Ghi chú">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                <polyline points="14 2 14 8 20 8"></polyline>
                <line x1="16" y1="13" x2="8" y2="13"></line>
                <line x1="16" y1="17" x2="8" y2="17"></line>
                <polyline points="10 9 9 9 8 9"></polyline>
              </svg>
            </button>
            <button id="toggleFullscreenStudy" type="button" class="secondary-btn" title="Phóng to">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"></path>
              </svg>
            </button>
          </div>
        </div>
        <div class="card" id="card">
          <div class="card-inner" id="cardInner">
            <div class="card-face card-front" id="cardFront">Mặt trước</div>
            <div class="card-face card-back" id="cardBack">Mặt sau</div>
          </div>
        </div>
        <div class="controls">
          <button id="prevBtn" type="button" class="secondary-btn">◀ Trước</button>
          <button id="nextBtn" type="button" class="secondary-btn">Tiếp ▶</button>
        </div>
        <div class="progress"><span id="progressIndex">0</span>/<span id="progressTotal">0</span></div>
      </div>
    </main>

    <main id="testView" class="view" hidden>
      <div class="test-area" id="testArea" hidden>
        <div class="view-controls" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; flex-wrap: wrap; gap: 8px;">
          <div class="direction-switch" style="display:flex;gap:8px;flex:1;">
            <div style="margin-bottom: 5px;">Chế độ:</div>
            <button id="dirDefToTerm" type="button" class="secondary-btn">Định nghĩa → Thuật ngữ</button>
            <button id="dirTermToDef" type="button" class="secondary-btn">Thuật ngữ → Định nghĩa</button>
          </div>
          <div style="display: flex; gap: 8px; align-items: center;">
            <button id="notesBtnTest" type="button" class="notes-btn" title="Ghi chú">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                <polyline points="14 2 14 8 20 8"></polyline>
                <line x1="16" y1="13" x2="8" y2="13"></line>
                <line x1="16" y1="17" x2="8" y2="17"></line>
                <polyline points="10 9 9 9 8 9"></polyline>
              </svg>
            </button>
            <button id="toggleFullscreenTest" type="button" class="secondary-btn" title="Phóng to">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"></path>
              </svg>
            </button>
          </div>
        </div>
        <div class="prompt" id="testPrompt"></div>
        <div class="test-input-container">
          <input type="text" id="testAnswer" class="url-input test-answer-input" placeholder="Nhập câu trả lời..." autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" />
          <div class="test-controls">
            <button id="skipBtn" type="button" class="secondary-btn">Bỏ qua</button>
            <button id="checkBtn" type="button" class="primary-btn">Kiểm tra</button>
          </div>
        </div>
        <div id="testFeedback" class="status"></div>
        <div class="progress"><span id="testIndex">0</span>/<span id="testTotal">0</span></div>
      </div>
    </main>

    <main id="summaryView" class="view" hidden>
      <div class="test-area">
        <div class="summary-header">Kết quả kiểm tra</div>
        <div class="summary-actions" style="display:flex; gap:8px; flex-wrap:wrap; margin:8px 0 12px;">
          <button id="btnSaveCorrect" type="button" class="secondary-btn">Lưu đáp án đúng (JSON)</button>
          <button id="btnSaveWrong" type="button" class="secondary-btn">Lưu đáp án sai (JSON)</button>
          <button id="btnUpdatePoints" type="button" class="primary-btn">Cập nhật điểm</button>
        </div>
        <div id="summaryArea" class="summary"></div>
      </div>
    </main>

    <main id="exportView" class="view" hidden>
      <div class="test-area">
        <div class="summary-header">Xuất ra Quizlet</div>
        <div style="display:flex; gap:8px; align-items:center; flex-wrap:wrap; margin:6px 0;">
          <label>Tách giữa Thuật ngữ và Định nghĩa: <input id="expSep1" type="text" value="{" style="width:80px" /></label>
          <label>Tách giữa các thẻ: <input id="expSep2" type="text" value="}" style="width:80px" /></label>
          <button id="btnExport" type="button" class="primary-btn">Tạo chuỗi</button>
        </div>
        <textarea id="exportBox" rows="6" style="width:100%;"></textarea>

        <div class="summary-header" style="margin-top:14px;">Xuất danh sách</div>
        <div style="display:flex; gap:12px; align-items:center; flex-wrap:wrap; margin:6px 0;">
          <label><input type="radio" name="expListMode" id="expListTerm" checked /> Thuật ngữ</label>
          <label><input type="radio" name="expListMode" id="expListDef" /> Định nghĩa</label>
          <button id="btnExportList" type="button" class="primary-btn">Tạo danh sách</button>
        </div>
        <textarea id="exportListBox" rows="6" style="width:100%;"></textarea>

        <div class="summary-header" style="margin-top:14px;">Xuất HTML độc lập</div>
        <div style="display:flex; gap:12px; align-items:center; flex-wrap:wrap; margin:6px 0;">
          <button id="btnExportStandalone" type="button" class="primary-btn">Tạo file HTML (thực hành + kiểm tra)</button>
        </div>
      </div>
    </main>

    <footer class="footer">
      <div>Tác giả: Albert Thai</div>
    </footer>
  </div>
  <!-- Notion Database Selection Modal -->
  <div id="notionModal" class="modal" style="display: none;">
    <div class="modal-content">
      <span class="close-btn">&times;</span>
      <h3>Lưu thẻ vào Notion</h3>
      <div class="form-group">
        <label for="notionDbName">Tên Database:</label>
        <input type="text" id="notionDbName" class="url-input" placeholder="Nhập tên Database" />
        <div class="hint">Nhập tên database để lưu thẻ. Nếu chưa tồn tại, hệ thống sẽ tự động tạo mới.</div>
      </div>
      <div id="notionStatus" class="status"></div>
      <div class="form-actions">
        <button id="btnSaveToNotion" class="primary-btn">Lưu vào Notion</button>
        <button id="btnCancelNotion" class="secondary-btn">Hủy</button>
      </div>
    </div>
  </div>

  <!-- Notes Modal -->
  <div id="notesModal" class="modal" style="display: none;">
    <div class="modal-content">
      <span class="close-btn" id="closeNotesModal">&times;</span>
      <h3>Ghi chú thẻ</h3>
      <div class="form-group">
        <label for="notesTextarea">Ghi chú của bạn:</label>
        <textarea id="notesTextarea" class="notes-textarea" placeholder="Nhập ghi chú cho thẻ này..." rows="6" style="width: 100%; padding: 8px; border: 1px solid #d7d7e7; border-radius: 8px; font-family: inherit; resize: vertical;"></textarea>
      </div>
      <div class="form-actions">
        <button id="btnSaveNotes" class="primary-btn">Lưu ghi chú</button>
        <button id="btnCancelNotes" class="secondary-btn">Hủy</button>
      </div>
    </div>
  </div>

  <script src="./app.js"></script>
</body>
</html>
